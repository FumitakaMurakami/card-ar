
<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

<script src="js/anime.min.js"></script>
<script src="https://rawgit.com/nicolocarpignoli/nicolocarpignoli.github.io/master/ar-click-events/events.js"></script>
<script>
  function run(id) {
        console.log("#" + id);
        const mid = "#" + id;
        var entity = document.querySelector(mid);

        var test = {
          posX: 0,
          posY: 0,
        };

        anime({
          targets: test,
          posY: 0,
          posX: 180,
          elasticity: 10000,
          update: function () {
            entity.setAttribute("rotation", {
              x: test.posX,
              y: 0,
              z: 0,
            });
            /* alert('clicked'); */
          },
          direction: "alternate",
          delay: 268,
          loop: false,
        });
      }
      AFRAME.registerComponent("turn", {
        update: function () {
          this.el.addEventListener("click", function (evt) {
            /* alert('clicked'); */
            console.log(this.id);
            run(this.id);
          });
        },
      });
      AFRAME.registerComponent('amarkerhandler', {

init: function() {
    const animatedMarker = document.querySelector("#animated-marker");
    const aEntity = document.querySelector("#animated-model");

    // every click, we make our model grow in size :)
    animatedMarker.addEventListener('click', function(ev, target){
        const intersectedElement = ev && ev.detail && ev.detail.intersectedEl;
        if (aEntity && intersectedElement === aEntity) {
            const scale = aEntity.getAttribute('scale');
            Object.keys(scale).forEach((key) => scale[key] = scale[key] + 1);
            aEntity.setAttribute('scale', scale);
        }
    });
}});
    </script>
<style>
  .after-click {
    text-align: center;
    font-size: 1.25em;
    color: transparent;
  }
  
</style>


<body>
  
  <a-scene
    vr-mode-ui="enabled: false;"
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
  >
    
  <a-marker preset="hiro" emitevents="true" cursor="rayOrigin: mouse" id="animated-marker" type='barcode' value='6' amarkerhandler>
    <a-entity
                id="animated-model"
                geometry="primitive: box; radius: 1"
                material="color: #cc0000"
                scale="1 0.05 2"
                position="1 0 0"
                scale="2">
            </a-entity>
    <!-- <a-entity
        id="sphere"
        geometry="primitive: box; radius: 1"
        material="color: #cc0000"
        scale="1 0.05 2"
        position="1 0 0"
        turn
      >
      </a-entity>
      <a-entity
        id="bluebox"
        geometry="primitive: box; radius: 1"
        material="color: blue"
        scale="1 0.05 2"
        position="-1 0 0"
        turn
      >
    </a-entity>
      <a-entity
        id="redbox"
        geometry="primitive: box; radius: 1"
        material="color: red"
        scale="1 0.05 2"
        position="0 1 0"
        turn
      >
      </a-entity> -->
  </a-marker>
    
    <a-entity camera><a-entity
      cursor="rayOrigin: mouse; fuse:false"
      material="color: black; shader: flat"
    >
    </a-entity>
  </a-scene>
</body>